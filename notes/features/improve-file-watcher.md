# ファイル監視機能の改善

## 目標
ccgitのファイル監視機能をTDDアプローチで改善する

## 特定した問題点
1. **テストカバレッジ不足**: 基本的なダミーテストのみ
2. **エラーハンドリングの改善**: ファイル監視やコミット処理でのエラー処理が不十分
3. **型安全性**: いくつかの関数で型定義が不完全
4. **デバウンス処理**: ファイル変更の検知でタイマーが適切にクリアされていない可能性
5. **重複コード**: `getStagedFiles`と`getGitStagedFiles`で似たような処理

## 改善計画
### Red-Green-Refactor サイクル 1: ファイル監視機能のテスト
- **Red**: ファイル監視機能が適切にファイル変更を検知し、デバウンス処理を行うことをテストする失敗テストを作成
- **Green**: テストが通るように実装を修正
- **Refactor**: コードの構造を改善

### Red-Green-Refactor サイクル 2: エラーハンドリング
- **Red**: エラー時の適切な処理をテストする失敗テストを作成
- **Green**: エラーハンドリングを実装
- **Refactor**: エラー処理の構造を改善

### Red-Green-Refactor サイクル 3: 重複コード削除
- **Red**: 既存機能の振る舞いを保証するテストを作成
- **Green**: 重複コードを統合
- **Refactor**: コードの可読性を向上

## 実装メモ
- Denoのテストモジュールを使用
- モック機能でファイルシステム操作をテスト
- 非同期処理とタイマーのテストに注意